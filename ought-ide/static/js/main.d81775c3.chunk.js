(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,r){e.exports=r(30)},30:function(e,t,r){"use strict";r.r(t);var i=r(0),n=r.n(i),a=r(9),s=r.n(a),o=r(8),u=r(2),c=r(15),h=r(16),l=r(19),d=r(3),p=r(6),f=r(7),m=/^:$/,v=/^[a-z$_]+[a-z0-9$_]*$/i,g=/^\n$/,y=/^;$/,S=/^"[^"]*"$/i,E=/^"$/,k=/^\s+$/,x=function(){function e(t){Object(p.a)(this,e),this.char=t}return Object(f.a)(e,[{key:"isTokenDelimiter",value:function(){return this.isWhitespace()||this.isNewline()||this.isSemicolon()||this.isColon()}},{key:"getValue",value:function(){return this.char}},{key:"isWhitespace",value:function(){return!!this.char.match(k)}},{key:"isSemicolon",value:function(){return!!this.char.match(y)}},{key:"isColon",value:function(){return!!this.char.match(m)}},{key:"isNewline",value:function(){return!!this.char.match(g)}},{key:"isEndOfStatement",value:function(){return this.isNewline()}},{key:"isStringDelimiter",value:function(){return!!this.char.match(E)}}]),e}(),b=function(){function e(t){Object(p.a)(this,e),this.tokenString=t}return Object(f.a)(e,[{key:"isKeyword",value:function(e){return this.tokenString===e}},{key:"isIdentifier",value:function(){return!!this.tokenString.match(v)}},{key:"isStringLiteral",value:function(){return!!this.tokenString.match(S)}},{key:"getStringValue",value:function(){return this.tokenString}}]),e}(),O=function(){function e(t){Object(p.a)(this,e),this.code=t,this.curLoc=void 0,this.isAtEndOfProgram=void 0,this.curLoc=0,this.isAtEndOfProgram=!1}return Object(f.a)(e,[{key:"generateAST",value:function(){return this.parseProgram()}},{key:"parseProgram",value:function(){for(var e,t=this.curLoc,r=[];e=this.parseStatement({nested:!1});)r.push(e);return{type:"Program",statements:r,loc:{start:t,end:this.curLoc}}}},{key:"parseStatement",value:function(e){var t=e.nested;this.skipWhitespace();var r,i=this.curLoc,n=this.peekAtNextToken();if(n.isKeyword("add")&&(r=this.parseAddStatement()),n.isKeyword("ifeq")&&(r=this.parseIfEqualStatement()),n.isKeyword("ifnoteq")&&(r=this.parseIfNotEqualStatement()),n.isKeyword("input")&&(r=this.parseInputStatement()),n.isKeyword("print")&&(r=this.parsePrintStatement()),n.isKeyword("run")&&(r=this.parseRunStatement()),n.isKeyword("set")&&(r=this.parseSetStatement()),n.isKeyword("stop")&&(r=this.parseStopStatement()),!this.isAtEndOfProgram&&this.curChar().isSemicolon()&&(r=this.parseSemicolonStatement(r)),t||this.eatEndOfStatement(),r){var a=this.curLoc;return Object(d.a)({},r,{loc:{start:i,end:a}})}if(this.isAtEndOfProgram)return!1;throw Error("Unknown statement type encountered")}},{key:"parseAddStatement",value:function(){if(!this.eatToken().isKeyword("add"))throw Error("Expected add keyword");return{type:"AddStatement",first:this.parseExpression(),second:this.parseExpression(),sum:this.parseIdentifier()}}},{key:"parseIfEqualStatement",value:function(){if(!this.eatToken().isKeyword("ifeq"))throw Error("Expected ifeq keyword");var e=this.parseExpression(),t=this.parseExpression();return this.skipWhitespace(),this.eatChar(":"),this.skipWhitespace(),{type:"IfEqualStatement",firstAntecedentValue:e,secondAntecedentValue:t,consequent:this.parseStatement({nested:!0})}}},{key:"parseIfNotEqualStatement",value:function(){if(!this.eatToken().isKeyword("ifnoteq"))throw Error("Expected ifnoteq keyword");var e=this.parseExpression(),t=this.parseExpression();return this.skipWhitespace(),this.eatChar(":"),this.skipWhitespace(),{type:"IfNotEqualStatement",firstAntecedentValue:e,secondAntecedentValue:t,consequent:this.parseStatement({nested:!0})}}},{key:"parseInputStatement",value:function(){if(!this.eatToken().isKeyword("input"))throw Error("Expected input keyword");return{type:"InputStatement",identifier:this.parseIdentifier()}}},{key:"parsePrintStatement",value:function(){if(!this.eatToken().isKeyword("print"))throw Error("Expected print keyword");return{type:"PrintStatement",expression:this.parseExpression()}}},{key:"parseRunStatement",value:function(){if(!this.eatToken().isKeyword("run"))throw Error("Expected run keyword");return{type:"RunStatement",program:this.parseExpression()}}},{key:"parseSemicolonStatement",value:function(e){return this.eatChar(";"),{type:"SemicolonStatement",firstStatement:e,secondStatement:this.parseStatement({nested:!0})}}},{key:"parseSetStatement",value:function(){if(!this.eatToken().isKeyword("set"))throw Error("Expected set keyword");return{type:"SetStatement",identifier:this.parseIdentifier(),expression:this.parseExpression()}}},{key:"parseStopStatement",value:function(){if(!this.eatToken().isKeyword("stop"))throw Error("Expected run keyword");return{type:"StopStatement"}}},{key:"eatEndOfStatement",value:function(){if(this.isThereANextChar()){for(var e=!1;this.curChar().isEndOfStatement()||this.curChar().isWhitespace();){if(this.curChar().isEndOfStatement()){this.isThereANextChar()?this.goToNextChar():this.isAtEndOfProgram=!0,e=!0;break}if(!this.isThereANextChar()){this.isAtEndOfProgram=!0;break}this.goToNextChar()}if(!e&&!this.isAtEndOfProgram)throw Error("Expected end of statement")}else this.isAtEndOfProgram=!0}},{key:"parseExpression",value:function(){this.skipWhitespace();var e=this.eatToken();if(e.isStringLiteral())return{type:"StringLiteral",value:e.getStringValue()};if(e.isIdentifier())return{type:"Identifier",value:e.getStringValue()};throw Error("Expression expected")}},{key:"parseIdentifier",value:function(){this.skipWhitespace();var e=this.eatToken();if(e.isIdentifier())return{type:"Identifier",value:e.getStringValue()};throw Error("Identifier expected")}},{key:"curChar",value:function(){return new x(this.code[this.curLoc])}},{key:"peekAtNextChar",value:function(){return new x(this.code[this.curLoc+1])}},{key:"eatChar",value:function(e){if(this.curChar().getValue()!==e)throw Error("Expected ".concat(e," character"));this.isThereANextChar()?this.goToNextChar():this.isAtEndOfProgram=!0}},{key:"eatToken",value:function(){this.skipWhitespace();var e="";if(this.curChar().isStringDelimiter())e=this.eatStringLiteral();else for(;!this.curChar().isTokenDelimiter();){if(e+=this.curChar().getValue(),!this.isThereANextChar()){this.isAtEndOfProgram=!0;break}this.goToNextChar()}return new b(e)}},{key:"eatStringLiteral",value:function(){var e="";if(!this.curChar().isStringDelimiter())throw Error("Expected string delimiter");if(e+=this.curChar().getValue(),!this.isThereANextChar())throw Error("Reached end of parsing in middle of string literal parsing");for(this.goToNextChar();!this.curChar().isStringDelimiter();){if(e+=this.curChar().getValue(),!this.isThereANextChar())throw Error("Reached end of parsing in middle of string literal parsing");this.goToNextChar()}return e+=this.curChar().getValue(),this.isThereANextChar()?this.goToNextChar():this.isAtEndOfProgram=!0,e}},{key:"peekAtNextToken",value:function(){for(var e=this.curLoc,t="";!this.curChar().isTokenDelimiter();){if(t+=this.curChar().getValue(),!this.isThereANextChar()){this.isAtEndOfProgram=!0;break}this.goToNextChar()}return this.curLoc=e,new b(t)}},{key:"skipWhitespace",value:function(){for(;this.curChar().isWhitespace();){if(!this.isThereANextChar()){this.isAtEndOfProgram=!0;break}this.goToNextChar()}}},{key:"isThereANextChar",value:function(){return this.curLoc+1<this.code.length}},{key:"goToNextChar",value:function(){this.curLoc++}}]),e}();function A(e){var t=e.code;return function(e,r){var i,n=new O(t);try{i=n.generateAST()}catch(a){return console.log("e",a),void e({type:"PARSING_ERROR",errorMsg:a.message})}e({type:"LOAD_PROGRAM",statements:i.statements})}}function w(e){var t=e.identifier,r=e.value;return function(e,i){e({type:"SAVE_VALUE",identifier:t,value:r})}}function T(e,t){return"StringLiteral"===e.type?e.value.slice(1,-1):t().variables[e.value]}function C(){return function(e,t){if("WAITING_FOR_INPUT"!==t().session.curState){var r=t().steps;if(0!==r.length){for(var i=r[0];Array.isArray(i);)i=i[0];"InputStatement"!==i.type?(e({type:"POP_STEP_OFF_STACK"}),e(function e(t){var r=t.statement;return function(t,i){if("AddStatement"===r.type){var n=T(r.first,i),a=T(r.second,i);t(w({identifier:r.sum.value,value:String(Number(n)+Number(a))}))}else if("IfEqualStatement"===r.type){var s=T(r.firstAntecedentValue,i),o=T(r.secondAntecedentValue,i),u=r.consequent;s===o&&t(e({statement:u}))}else if("IfNotEqualStatement"===r.type){var c=T(r.firstAntecedentValue,i),h=T(r.secondAntecedentValue,i),l=r.consequent;c!==h&&t(e({statement:l}))}else"PrintStatement"===r.type?t({type:"PRINT_LINE",value:T(r.expression,i)}):"RunStatement"===r.type?t(A({code:T(r.program,i)})):"SetStatement"===r.type?t(w({identifier:r.identifier.value,value:T(r.expression,i)})):"SemicolonStatement"===r.type?(t(e({statement:r.firstStatement})),t(e({statement:r.secondStatement}))):"StopStatement"===r.type&&t({type:"STOP"})}}({statement:i})),t().session.autoRun&&e(C())):e({type:"CHANGE_CUR_STATE",curState:"WAITING_FOR_INPUT"})}}}}var N={handleLoadProgram:function(e){return function(e){var t=e.identifier;return function(e,r){e(A({code:r().variables[t]}))}}({identifier:e.identifier})},handleRunNextStep:function(){return C()},handleSaveValue:function(e){return w({identifier:e.identifier,value:e.value})}},I=Object(o.b)(function(e){return{hasProgramBeenLoaded:e.steps.length>0}},N)(function(e){var t=e.handleLoadProgram,r=e.handleRunNextStep,i=e.handleSaveValue,a=e.hasProgramBeenLoaded,s=e.variable;return n.a.createElement("div",{style:{marginBottom:"10px"}},n.a.createElement("div",{style:{color:"#999",fontSize:"12px",fontWeight:600}},s.identifier),n.a.createElement("textarea",{onChange:function(e){i({identifier:s.identifier,value:e.target.value})},style:{fontSize:"16px",lineHeight:"20px",height:20*s.value.split(/\r\n|\r|\n/).length+"px",width:"400px"},value:s.value}),n.a.createElement("br",null),n.a.createElement("button",{disabled:a,onClick:function(){t({identifier:s.identifier}),r({identifier:s.identifiers})},style:{marginRight:"10px"}},"load and run"))});function P(e){var t=e.value;return function(e,r){e({type:"SUBMIT_INPUT",value:t}),e(function(e,t){if("WAITING_FOR_INPUT"!==t().session.curState){for(var r=t().steps[0];Array.isArray(r);)r=r[0];e({type:"SAVE_VALUE",identifier:r.identifier.value,value:t().session.inputValue}),e({type:"POP_STEP_OFF_STACK"}),t().session.autoRun&&e(C())}})}}var L={handleNewValue:function(e){return w({identifier:e.identifier,value:""})},handleValue:function(e){return w({identifier:e.identifier,value:""})},handleSubmitInput:function(e){return P({value:e.value})},handleToggleAutoRun:function(){return function(e,t){e({type:"TOGGLE_AUTO_RUN"})}}},R=Object(o.b)(function(e){return{parsingErrorMsg:e.session.parsingError,printedLines:e.printedLines,isWaitingForInput:"WAITING_FOR_INPUT"===e.session.curState,variables:l.keys(e.variables).map(function(t){return{identifier:t,value:e.variables[t]}})}},L)(function(e){var t=e.handleNewValue,r=e.handleSubmitInput,a=e.isWaitingForInput,s=e.parsingErrorMsg,o=e.printedLines,u=e.variables,c=Object(i.useState)(""),l=Object(h.a)(c,2),d=l[0],p=l[1],f=Object(i.useState)(""),m=Object(h.a)(f,2),v=m[0],g=m[1];return n.a.createElement("div",{style:{display:"flex",margin:"100px auto",width:"1000px",transform:"scale(1.2, 1.2)"}},n.a.createElement("div",{style:{padding:"30px",width:"440px"}},s&&n.a.createElement("div",{style:{color:"red",marginBottom:"20px "}},"Parsing error: ",s),n.a.createElement("input",{onChange:function(e){return p(e.target.value)},type:"text",value:d}),n.a.createElement("button",{onClick:function(){return t({identifier:d})},style:{marginLeft:"5px"}},"Create new variable"),n.a.createElement("div",{style:{height:"20px"}}),a&&n.a.createElement("div",null,"Input",n.a.createElement("div",null,n.a.createElement("input",{style:{border:"1px solid red",marginRight:"10px"},onChange:function(e){return g(e.target.value)},type:"text",value:v}),n.a.createElement("button",{onClick:function(){return r({value:v})}},"Submit user input"))),n.a.createElement("div",{style:{height:"20px"}}),n.a.createElement("div",null,"Output",n.a.createElement("div",{style:{backgroundColor:"#eee",border:"1px solid gray",color:"#111",fontFamily:"monospace",minHeight:"50px"}},o.map(function(e,t){return n.a.createElement("div",{key:t},e)})))),n.a.createElement("div",{style:{width:"500px"}},u.map(function(e){return n.a.createElement(I,{variable:e,key:e.identifier})})))}),_=r(4),V=[];var j={autoRun:!0,curState:"IDLE",inputValue:void 0,parsingError:void 0,runtimeError:void 0},W=[];var q=r(10),K={fib:'print "Which Fibonacci number do you want to calculate?"\ninput n\nset a "0"\nset b "1"\nifeq n "0": print a; stop\nset i "2"\nrun fibLoop',fibLoop:'add a b c\nset a b\nset b c\nifeq i n: print b; stop\nifnoteq i n: add i "1" i; run fibLoop'};var U,F=Object(u.c)({printedLines:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0;return"PRINT_LINE"===t.type?[].concat(Object(_.a)(e),[t.value]):e},session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0;return"CHANGE_CUR_STATE"===t.type?Object(d.a)({},e,{curState:t.curState}):"SUBMIT_INPUT"===t.type?Object(d.a)({},e,{curState:"IDLE",inputValue:t.value}):"TOGGLE_AUTO_RUN"===t.type?Object(d.a)({},e,{autoRun:!e.autoRun}):"PARSING_ERROR"===t.type?(console.log("here"),Object(d.a)({},e,{parsingError:t.errorMsg})):e},steps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,t=arguments.length>1?arguments[1]:void 0;return"LOAD_PROGRAM"===t.type?[Object(_.a)(t.statements)].concat(Object(_.a)(e)):"POP_STEP_OFF_STACK"===t.type?1===e[0].length?(console.log(e,"++====>",e.slice(1)),e.slice(1)):(console.log(e,"====>",[Object(_.a)(e[0].slice(1))].concat(Object(_.a)(e.slice(1)))),[Object(_.a)(e[0].slice(1))].concat(Object(_.a)(e.slice(1)))):"STOP"===t.type?e.slice(1):e},variables:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1?arguments[1]:void 0;return"SAVE_VALUE"===t.type?Object(d.a)({},e,Object(q.a)({},t.identifier,t.value)):e}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));(U=null!==localStorage.getItem("ought-ide")?Object(u.d)(F,JSON.parse(localStorage.getItem("ought-ide")),Object(u.a)(c.a)):Object(u.d)(F,Object(u.a)(c.a))).subscribe(function(){return localStorage.setItem("ought-ide",JSON.stringify(U.getState()))}),s.a.render(n.a.createElement(o.a,{store:U},n.a.createElement(R,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[20,1,2]]]);
//# sourceMappingURL=main.d81775c3.chunk.js.map